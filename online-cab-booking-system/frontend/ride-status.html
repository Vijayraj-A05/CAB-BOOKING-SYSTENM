<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CabConnect - Ride Status</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        .radar-container {
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .radar-pulse {
            position: absolute;
            border: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: radar 2s infinite ease-out;
            opacity: 0;
        }

        .radar-pulse:nth-child(2) {
            animation-delay: 0.5s;
        }

        .radar-pulse:nth-child(3) {
            animation-delay: 1s;
        }

        @keyframes radar {
            0% {
                transform: scale(1);
                opacity: 0.8;
            }

            100% {
                transform: scale(4);
                opacity: 0;
            }
        }

        .driver-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 480px;
            z-index: 100;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--gray-500);
            display: inline-block;
            margin-right: 8px;
        }

        .status-dot.active {
            background: var(--primary-color);
            box-shadow: 0 0 5px var(--primary-color);
        }
    </style>
</head>

<body>
    <header class="app-header">
        <h1>Ride Status</h1>
        <span class="badge"
            style="background: rgba(255,255,255,0.2); padding: 4px 8px; border-radius: 4px; font-size: 0.8rem;"
            id="ride-id">#ID</span>
    </header>

    <div class="app-container" style="box-shadow: none; background: #f8f9fa;">

        <!-- Map Placeholder -->
        <div
            style="height: 100%; min-height: 400px; background: #e9ecef; display: flex; align-items: center; justify-content: center; flex-direction: column; color: var(--gray-500);">
            <div id="radar-view" class="radar-container hidden">
                <div class="radar-pulse"></div>
                <div class="radar-pulse"></div>
                <div class="radar-pulse"></div>
                <i class="fa-solid fa-car-side" style="font-size: 2rem; color: var(--text-dark); z-index: 2;"></i>
                <p style="margin-top: 150px; font-weight: 500;">Finding a driver nearby...</p>
            </div>

            <div id="map-view" class="hidden text-center">
                <i class="fa-regular fa-map" style="font-size: 4rem; margin-bottom: 20px;"></i>
                <h2 id="map-message">Navigate</h2>
            </div>
        </div>

        <!-- Driver / Status Panel -->
        <div class="driver-card p-3 animate-slide-up">
            <!-- Status Header -->
            <div class="mb-3 border-bottom pb-2" style="border-color: var(--gray-200);">
                <h2 id="status-text" class="text-primary">Preparing...</h2>
                <div class="d-flex align-center mt-1">
                    <span class="status-dot active"></span>
                    <small class="text-muted" id="sub-status">Please wait</small>
                </div>
            </div>

            <!-- Driver Info (Hidden initially) -->
            <div id="driver-info" class="hidden mb-3">
                <div class="d-flex justify-between align-center">
                    <div class="d-flex align-center gap-2">
                        <div
                            style="width: 50px; height: 50px; background: var(--gray-200); border-radius: 50%; overflow: hidden;">
                            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="Driver"
                                id="driver-img" width="50" height="50">
                        </div>
                        <div>
                            <h3 id="driver-name" style="margin: 0; font-size: 1rem;">Driver Name</h3>
                            <span class="text-sm text-muted"> <i class="fa-solid fa-star" style="color: gold;"></i>
                                4.8</span>
                        </div>
                    </div>
                    <div class="text-right">
                        <h3 id="car-number" style="margin: 0; font-size: 1.1rem;">MH 12 AB 1234</h3>
                        <small id="car-model" class="text-muted">White Sedan</small>
                    </div>
                </div>

                <div class="d-flex justify-between mt-3 gap-2">
                    <button class="btn btn-secondary" style="flex: 1;"><i class="fa-solid fa-phone"></i> Call</button>
                    <button class="btn btn-secondary" style="flex: 1;"><i class="fa-solid fa-message"></i> Msg</button>
                </div>
            </div>

            <!-- Ride Details -->
            <div class="d-flex justify-between align-center mt-2 p-2"
                style="background: var(--gray-100); border-radius: 8px;">
                <div>
                    <small class="text-muted">Destination</small>
                    <p style="font-weight: 600;" id="drop-text">Home</p>
                </div>
                <div class="text-right">
                    <small class="text-muted">Fare</small>
                    <p style="font-weight: 600;" id="fare-text">â‚¹200</p>
                </div>
            </div>

            <!-- Actions -->
            <div class="mt-3">
                <button id="cancel-btn" class="btn btn-danger">Cancel Ride</button>
                <button id="home-btn" class="btn btn-primary hidden">Back to Home</button>
            </div>
        </div>

    </div>

    <script src="js/storage.js"></script>
    <script src="js/ride.js"></script>
    <script>
        checkAuth();
    </script>
</body>

</html>